{% extends "base.html" %}

{% set active_page = "index" %}

{% block extra_styles %}
  <link
    href="{{ relative_path_for('static', path='/css/index.css') }}"
    rel="stylesheet"
  />
{% endblock %}

{% block main_content %}
  {% if characters %}
    <div
      class="album py-5 bg-light"
    >
      <div
        class="container"
      >
        <div
          class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4"
        >
          {% for character in characters %}
            <div
              class="col"
            >
              <div
                class="card character-card h-100 border-0 shadow-sm"
              >
                <div
                  class="character-image-wrapper"
                >
                  <img
                    src="{{ character.relative_image_url }}"
                    alt="{{ character.name }}"
                    class="character-image"
                    loading="lazy"
                  />
                </div>
                <div
                  class="card-body d-flex flex-column"
                >
                  <div
                    class="mb-2 character-name"
                  >
                    {{ character.name }}
                  </div>
                  <div
                    class="character-meta mb-3"
                  >
                    <span
                      class="badge badge-status badge-status-{{ character.status.value|lower }}"
                    >
                      {{ character.status.value|capitalize }}
                    </span>
                    <span
                      class="badge badge-gender badge-gender-{{ character.gender.value|lower }}"
                    >
                      {{ character.gender.value|capitalize }}
                    </span>
                    <span
                      class="badge badge-species badge-species-{{ character.species.value|lower }}"
                    >
                      {{ character.species.value|capitalize }}
                    </span>
                  </div>
                  <div
                    class="mt-auto d-flex justify-content-between align-items-center"
                  >
                    <a
                      href="#"
                      class="btn btn-sm btn-outline-secondary"
                      data-bs-toggle="modal"
                      data-bs-target="#character-modal"
                      data-character-id="{{ character.id }}"
                    >
                      View
                    </a>
                    <small
                      class="text-muted"
                    >
                      #{{ character.id }}
                    </small>
                  </div>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
    <div
      class="modal fade"
      id="character-modal"
      tabindex="-1"
      aria-hidden="true"
    >
      <div
        class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable"
      >
        <div
          class="modal-content"
        >
          <div
            class="modal-header align-items-start"
          >
            <div
              class="flex-grow-1"
            >
              <h4
                class="modal-title mb-0"
                id="modal-character-name"
              >
                Loading...
              </h4>
              <code
                id="modal-endpoint"
                class="small text-muted"
              ></code>
            </div>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div
            class="modal-body p-0"
          >
            <div
              class="p-4 border-bottom text-center"
            >
              <div
                class="mb-2"
              >
                <img
                  id="modal-character-image"
                  class="img-fluid rounded shadow-sm"
                  width="280"
                  height="280"
                  alt=""
                  src=""
                  loading="lazy"
                />
              </div>
              <div
                class="d-flex justify-content-center gap-1 flex-wrap"
              >
                <span
                  id="modal-status"
                  class="badge"
                ></span>
                <span
                  id="modal-gender"
                  class="badge"
                ></span>
                <span
                  id="modal-species"
                  class="badge"
                ></span>
              </div>
            </div>
            <div
              class="p-4"
            >
              <div
                class="mb-1 fw-semibold small text-muted"
              >
                API response
              </div>
              <pre
                id="modal-json"
                class="bg-light p-3 rounded small"
                style="max-height: 320px; overflow: auto;"
              ></pre>
            </div>
          </div>
        </div>
      </div>
    </div>
  {% endif %}
{% endblock %}

{% block extra_scripts %}
  <script
    src="{{ relative_path_for('static', path='/js/index.js') }}"
  ></script>
{% endblock %}
